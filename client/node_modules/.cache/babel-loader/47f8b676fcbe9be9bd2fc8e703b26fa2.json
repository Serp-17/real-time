{"ast":null,"code":"var _jsxFileName = \"/Users/sergeikarpuk/www/priv/real-time/client/src/components/longpuling.jsx\",\n    _s = $RefreshSig$();\n\nimport { Button, Form } from 'react-bootstrap';\nimport { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const LongPuling = () => {\n  _s();\n\n  const [messages, setMessages] = useState([]);\n  const [value, setValue] = useState(\"\");\n  useEffect(() => {\n    subscribe();\n  }, []);\n\n  const subscribe = async () => {\n    try {\n      const {\n        data\n      } = await axios.get(\"http://localhost:5000/get-messages\");\n      setMessages(prev => [data, ...prev]);\n      await subscribe();\n    } catch {\n      setTimeout(() => {\n        subscribe();\n      }, 5000);\n    }\n  };\n\n  const editInput = e => {\n    setValue(e.target.value);\n  };\n\n  const sendMessage = async () => {\n    await axios.post(\"http://localhost:5000/new-messages\", {\n      messages: value,\n      id: Date.now()\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Form, {\n      className: \"d-flex justify-content-center\",\n      children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n        className: \"mr-3\",\n        controlId: \"exampleForm.ControlTextarea1\",\n        children: /*#__PURE__*/_jsxDEV(Form.Control, {\n          type: \"text\",\n          onChange: e => editInput(e),\n          defaultValue: \"\",\n          value: value\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 40,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        onClick: sendMessage,\n        children: \"Submit\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: messages.map(mess => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"message\",\n        children: mess.message\n      }, mess.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 21\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n};\n\n_s(LongPuling, \"GTmeqL2QM7WRHZPP9RGDJZrJ0MM=\");\n\n_c = LongPuling;\n\nvar _c;\n\n$RefreshReg$(_c, \"LongPuling\");","map":{"version":3,"names":["Button","Form","useState","useEffect","axios","LongPuling","messages","setMessages","value","setValue","subscribe","data","get","prev","setTimeout","editInput","e","target","sendMessage","post","id","Date","now","map","mess","message"],"sources":["/Users/sergeikarpuk/www/priv/real-time/client/src/components/longpuling.jsx"],"sourcesContent":["import { Button, Form } from 'react-bootstrap';\nimport { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nexport const LongPuling = () => {\n    const [messages, setMessages] = useState([]);\n    const [value, setValue] = useState(\"\");\n\n    useEffect(() => {\n        subscribe();\n    }, [])\n\n    const subscribe = async () => {\n        try {\n            const { data } = await axios.get(\"http://localhost:5000/get-messages\");\n            setMessages(prev => [data, ...prev])\n            await subscribe();\n        } catch {\n            setTimeout(() => {\n                subscribe()\n            }, 5000)\n        }\n    }\n\n    const editInput = (e) => {\n        setValue(e.target.value);\n    }\n\n    const sendMessage = async () => {\n        await axios.post(\"http://localhost:5000/new-messages\", {\n            messages: value,\n            id: Date.now()\n        })\n    }\n\n    return (\n        <>\n            <Form className=\"d-flex justify-content-center\">\n                <Form.Group className=\"mr-3\" controlId=\"exampleForm.ControlTextarea1\">\n                    <Form.Control type=\"text\" onChange={e => editInput(e)} defaultValue=\"\" value={ value } />\n                </Form.Group>\n                <Button onClick={sendMessage}>\n                    Submit\n                </Button>\n            </Form>\n            <div>\n                {messages.map(mess =>\n                    <div className=\"message\" key={mess.id}>\n                        {mess.message}\n                    </div>\n                )}\n            </div>\n        </>\n    )\n};\n"],"mappings":";;;AAAA,SAASA,MAAT,EAAiBC,IAAjB,QAA6B,iBAA7B;AACA,SAASC,QAAT,EAAmBC,SAAnB,QAAoC,OAApC;AACA,OAAOC,KAAP,MAAkB,OAAlB;;;AAEA,OAAO,MAAMC,UAAU,GAAG,MAAM;EAAA;;EAC5B,MAAM,CAACC,QAAD,EAAWC,WAAX,IAA0BL,QAAQ,CAAC,EAAD,CAAxC;EACA,MAAM,CAACM,KAAD,EAAQC,QAAR,IAAoBP,QAAQ,CAAC,EAAD,CAAlC;EAEAC,SAAS,CAAC,MAAM;IACZO,SAAS;EACZ,CAFQ,EAEN,EAFM,CAAT;;EAIA,MAAMA,SAAS,GAAG,YAAY;IAC1B,IAAI;MACA,MAAM;QAAEC;MAAF,IAAW,MAAMP,KAAK,CAACQ,GAAN,CAAU,oCAAV,CAAvB;MACAL,WAAW,CAACM,IAAI,IAAI,CAACF,IAAD,EAAO,GAAGE,IAAV,CAAT,CAAX;MACA,MAAMH,SAAS,EAAf;IACH,CAJD,CAIE,MAAM;MACJI,UAAU,CAAC,MAAM;QACbJ,SAAS;MACZ,CAFS,EAEP,IAFO,CAAV;IAGH;EACJ,CAVD;;EAYA,MAAMK,SAAS,GAAIC,CAAD,IAAO;IACrBP,QAAQ,CAACO,CAAC,CAACC,MAAF,CAAST,KAAV,CAAR;EACH,CAFD;;EAIA,MAAMU,WAAW,GAAG,YAAY;IAC5B,MAAMd,KAAK,CAACe,IAAN,CAAW,oCAAX,EAAiD;MACnDb,QAAQ,EAAEE,KADyC;MAEnDY,EAAE,EAAEC,IAAI,CAACC,GAAL;IAF+C,CAAjD,CAAN;EAIH,CALD;;EAOA,oBACI;IAAA,wBACI,QAAC,IAAD;MAAM,SAAS,EAAC,+BAAhB;MAAA,wBACI,QAAC,IAAD,CAAM,KAAN;QAAY,SAAS,EAAC,MAAtB;QAA6B,SAAS,EAAC,8BAAvC;QAAA,uBACI,QAAC,IAAD,CAAM,OAAN;UAAc,IAAI,EAAC,MAAnB;UAA0B,QAAQ,EAAEN,CAAC,IAAID,SAAS,CAACC,CAAD,CAAlD;UAAuD,YAAY,EAAC,EAApE;UAAuE,KAAK,EAAGR;QAA/E;UAAA;UAAA;UAAA;QAAA;MADJ;QAAA;QAAA;QAAA;MAAA,QADJ,eAII,QAAC,MAAD;QAAQ,OAAO,EAAEU,WAAjB;QAAA;MAAA;QAAA;QAAA;QAAA;MAAA,QAJJ;IAAA;MAAA;MAAA;MAAA;IAAA,QADJ,eASI;MAAA,UACKZ,QAAQ,CAACiB,GAAT,CAAaC,IAAI,iBACd;QAAK,SAAS,EAAC,SAAf;QAAA,UACKA,IAAI,CAACC;MADV,GAA8BD,IAAI,CAACJ,EAAnC;QAAA;QAAA;QAAA;MAAA,QADH;IADL;MAAA;MAAA;MAAA;IAAA,QATJ;EAAA,gBADJ;AAmBH,CAlDM;;GAAMf,U;;KAAAA,U"},"metadata":{},"sourceType":"module"}